<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qly.mapper.InquiryMapper">

	<!-- ✅ 1:1 문의 등록 - 시퀀스로 QUESTION_ID 생성 -->
	<insert id="insertInquiry"
		parameterType="com.qly.dto.InquiryDto">
		<selectKey keyProperty="questionId" resultType="int"
			order="BEFORE">
			SELECT SEQ_QUESTION_ID.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO QUESTIONS (
		QUESTION_ID, TITLE, USER_ID, CREATED_DATE,
		ANSWER_STATUS, ANSWER_CONTENT
		) VALUES (
		#{questionId, jdbcType=INTEGER},
		#{title, jdbcType=VARCHAR},
		#{userId, jdbcType=INTEGER},
		SYSDATE,
		#{answerStatus, jdbcType=VARCHAR},
		#{answerContent, jdbcType=VARCHAR}
		)
	</insert>


	<!-- ✅ 사용자별 문의 목록 조회 -->
	<select id="selectByUserId" parameterType="int"
		resultType="com.qly.dto.InquiryDto">
		SELECT
		QUESTION_ID,
		TITLE,
		USER_ID,
		CREATED_DATE,
		ANSWER_STATUS,
		ANSWER_CONTENT
		FROM QUESTIONS
		WHERE USER_ID = #{userId}
		ORDER BY CREATED_DATE DESC
	</select>

	<!-- ✅ 전체 문의 목록 조회 -->
	<select id="selectAll" resultType="com.qly.dto.InquiryDto">
		SELECT
		QUESTION_ID,
		TITLE,
		USER_ID,
		CREATED_DATE,
		ANSWER_STATUS,
		ANSWER_CONTENT
		FROM QUESTIONS
		ORDER BY CREATED_DATE DESC
	</select>

	<!-- ✅ 문의 상세 조회 -->
	<select id="selectById" parameterType="int"
		resultType="com.qly.dto.InquiryDto">
		SELECT
		QUESTION_ID,
		TITLE,
		USER_ID,
		CREATED_DATE,
		ANSWER_STATUS,
		ANSWER_CONTENT
		FROM QUESTIONS
		WHERE QUESTION_ID = #{questionId}
	</select>

</mapper>
