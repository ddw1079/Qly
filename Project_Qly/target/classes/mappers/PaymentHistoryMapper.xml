<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qly.mapper.PaymentHistoryMapper">
    <!-- 1. 결제 히스토리 전체 조회 -->
    <select id="findAllHistories" resultType="com.qly.vo.PaymentHistoryVo" parameterType="string">
        SELECT
            PAYMENT_HISTORY_ID,
            USER_ID,
            PAYMENT_DATE,
            AMOUNT,
            REMAIN_COIN,
            TYPE,
            STATUS
        FROM PAYMENT_HISTORY
    </select>

    <!-- 2. 특정 유저의 결제 히스토리 조회 -->
    <select id="findHistoriesByUserId" parameterType="string" resultType="com.qly.vo.PaymentHistoryVo">
        SELECT
            PAYMENT_HISTORY_ID,
            USER_ID,
            PAYMENT_DATE,
            AMOUNT,
            REMAIN_COIN,
            TYPE,
            STATUS
        FROM PAYMENT_HISTORY
        WHERE USER_ID = #{userId}
    </select>

    <!-- 3. 결제 히스토리 추가 -->
    <insert id="insertHistory" parameterType="com.qly.vo.PaymentHistoryVo">
        INSERT INTO PAYMENT_HISTORY (USER_ID, AMOUNT, REMAIN_COIN, PAYMENT_DATE, TYPE, STATUS)
        VALUES (#{userId}, #{amount}, #{remainCoin}, NOW(), #{paymentMethod}, #{status})
    </insert>

</mapper>