<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qly.mapper.CoinHistoryMapper">

    <!-- 1. 코인 히스토리 전체 조회 -->
    <select id="findAllHistories" resultType="com.qly.vo.CoinHistoryVo">
        SELECT
            USER_ID,
            AMOUNT,
            REMAIN_COIN,
            TYPE,
            TRANSACTION_DATE,
            QUEST_ID
        FROM COIN_HISTORY
    </select>

    <!-- 2. 특정 유저의 코인 히스토리 조회 -->
    <select id="findHistoriesByUserId" resultType="com.qly.vo.CoinHistoryVo">
        SELECT
            USER_ID,
            AMOUNT,
            REMAIN_COIN,
            TYPE,
            TRANSACTION_DATE,
            QUEST_ID
        FROM COIN_HISTORY
        WHERE USER_ID = #{userId}
    </select>

    <!-- 3. 코인 히스토리 추가 -->
    <insert id="insertHistory" parameterType="com.qly.vo.CoinHistoryVo">
        INSERT INTO COIN_HISTORY (USER_ID, AMOUNT, REMAIN_COIN, TYPE, TRANSACTION_DATE, QUEST_ID)
        VALUES (#{userId}, #{amount}, #{remainCoin}, #{type}, NOW(), #{questId})
    </insert>

</mapper>